以下是针对酒吧H5项目的完整产品架构、功能设计及技术流程说明，采用Markdown格式分模块呈现：


### 一、产品架构设计
#### 1. 分层架构图
```
客户端层（User Interface）
├─ H5前端（Vue.js + Vant UI）
│  ├─ 酒单模块
│  ├─ 留言板模块
│  ├─ 今天喝什么模块
│  └─ 关于酒吧模块

网络层（Network）
├─ Nginx反向代理（静态资源+CORS配置）
└─ HTTPS安全传输

应用服务层（Application Service）
├─ Spring Boot后端（RESTful API）
│  ├─ 酒单服务
│  ├─ 留言板服务
│  ├─ 推荐服务（今天喝什么）
│  ├─ 后台管理服务
│  └─ OSS文件存储服务

数据层（Data）
├─ MySQL数据库（核心业务数据）
├─ 阿里云OSS（留言板图片存储）

基础设施层（Infrastructure）
├─ 服务器（Linux/CentOS）
├─ Docker容器化部署
└─ 日志监控（ELK/Sentry）
```


### 二、前台功能模块设计（用户端）
#### 1. 酒吧酒单模块
- **核心功能**  
  - 酒品分类展示（按基酒类型：威士忌/伏特加/果味酒等）  
  - 酒品详情页（名称、酒精度、原料、口感描述、图片预览、价格）  
  - 分类筛选/搜索（支持关键词搜索、热门标签筛选）  
- **交互设计**  
  - 滑动轮播图展示招牌酒品  
  - 点击酒品图片弹出大图预览  
  - 底部导航栏固定入口（图标+文字）

#### 2. 酒吧留言板模块  
- **核心功能**  
  - 留言分类（默认分类/热门话题/最新留言，顶部标签切换）  
  - 留言列表（显示用户名/头像/内容/点赞数/回复数/发布时间）  
  - 互动功能：  
    - 点赞（防重复点赞，记录用户IP或设备ID）  
    - 回复（需填写昵称，回复数统计）  
    - 删除/编辑（仅用户本人可操作，管理员后台删除）  
  - 提交留言（富文本限制：仅支持文字+表情，图片上传至OSS）  
- **数据规则**  
  - 每页显示10条留言，支持分页加载  
  - 敏感词过滤（后端校验：政治/色情/广告关键词）  

#### 3. 今天喝什么模块  
- **核心功能**  
  - 问答式推荐流程（3-5步选择题，如：心情状态/场合/偏好口味）  
  - 动态推荐算法（基于规则引擎或简单匹配逻辑，如：  
    - 选择“解压”→推荐“长岛冰茶”“莫吉托”  
    - 选择“生日”→推荐“香槟”“龙舌兰日出”）  
- **交互设计**  
  - 可视化选择组件（单选按钮/滑块/表情评分）  
  - 每一步展示当前进度（“第2/3步”）  
  - 结果页：推荐酒品列表（附推荐理由、图片、酒精度提示）  

#### 4. 关于酒吧模块  
- **基础功能**  
  - 酒吧简介（地址/营业时间/联系方式/品牌故事）  
  - 团队介绍（调酒师团队/特色服务）  
  - 图片展示（环境图/活动图，轮播图形式）  


### 三、后台管理模块设计（隐藏入口）  
#### 1. 登录认证  
- 隐藏入口：通过特定URL（如`/admin/login`）或扫码登录  
- 认证方式：账号密码（加盐哈希）+ 短信验证码（可选）  
- 权限控制：单一管理员角色（后续可扩展多角色，当前需求暂不涉及）  

#### 2. 核心管理功能  
- **留言板管理**  
  - 留言列表（支持筛选、排序：按时间/类型/状态）  
  - 操作按钮：置顶（单条/多条）、删除、标记敏感（自动过滤）  
  - 数据统计：今日留言数/热门留言TOP10（按点赞数）  

- **酒单管理**  
  - 酒品CRUD：图片上传（OSS直链）  
  - 分类管理：新增/编辑分类，调整展示顺序  
  - 状态控制：上架/下架（隐藏已下架酒品）  

- **推荐服务管理**  
  - 问题库维护：新增/编辑问答题目、选项、权重值  
  - 推荐规则配置：设置不同选项对应的推荐酒品组合  


### 四、技术架构设计  
#### 1. 前端（Vue.js生态）  
- **技术栈**  
  - 框架：Vue 3 + Vue Router + Vuex/Pinia（状态管理）  
  - UI组件：Vant UI（移动端适配）+ Element Plus（后台管理）  
  - 工具链：Webpack/Vite + Axios（HTTP请求）+ Eslint/Prettier  
  - 交互优化：骨架屏（NProgress加载状态）+ 懒加载（图片/路由）  

- **特殊处理**  
  - 移动端适配：rem布局 + @media媒体查询  
  - 文件上传：封装OSS上传组件（生成临时签名URL）    

#### 2. 后端（Spring Boot生态）  
- **技术栈**  
  - 核心框架：Spring Boot 3 + Spring Security（权限控制）  
  - 数据访问：MyBatis-Plus + MySQL Connector  
  - 文件存储：阿里云OSS SDK（Java客户端）  
  - 日志：SLF4J + Logback + AOP统一日志切面  

- **接口设计**  
  - RESTful规范：  
    - 酒单：`GET /api/drinks`（分页）/ `POST /api/drinks`（管理员新增）  
    - 留言：`POST /api/comments`（提交）/ `PUT /api/comments/{id}`（修改）  
    - 推荐：`POST /api/recommend`（提交选项，返回推荐结果）  

- **安全机制**  
  - 敏感数据：密码MD5+盐值加密，OSS临时URL签名（有效期10分钟）  


### 五、数据库设计（核心表结构）  
#### 1. 酒单相关表  
| 表名          | 字段说明                          | 关联关系         |  
|---------------|-----------------------------------|------------------|  
| drink_category | 分类ID, 分类名称, 排序值, 父分类ID | 自关联（一级分类）|  
| drink         | 酒品ID, 名称, 价格, 描述, 图片URL, 分类ID, 上架状态 | 外键→drink_category |  

#### 2. 留言板相关表  
| 表名          | 字段说明                          | 关联关系         |  
|---------------|-----------------------------------|------------------|  
| comment       | 留言ID, 用户名, 头像URL, 内容, 点赞数, 发布时间, 分类标签 | 无               |  
| reply         | 回复ID, 留言ID, 昵称, 内容, 回复时间 | 外键→comment     |  
| oss_image     | 图片ID, 原始URL, 缩略图URL, 所属留言ID | 外键→comment     |  

#### 3. 推荐服务相关表  
| 表名          | 字段说明                          | 关联关系         |  
|---------------|-----------------------------------|------------------|  
| question      | 问题ID, 问题描述, 类型（单选/多选） | 无               |  
| option        | 选项ID, 问题ID, 选项内容, 权重值    | 外键→question    |  
| recommendation| 推荐规则ID, 选项组合, 目标酒品ID    | 多对多→option   |  


### 六、核心流程设计  
#### 1. 用户访问流程  
```
用户打开H5链接 → Nginx反向代理 → 加载Vue静态资源 → 路由匹配对应模块  
├─ 酒单模块：调用/drinks接口 → 渲染酒品列表 → 点击详情→加载单个酒品数据  
├─ 留言板模块：调用/comments接口 → 分页加载留言 → 点赞/回复→发送PUT/POST请求  
└─ 今天喝什么：调用/recommend/init接口 → 逐步提交选项→最终返回推荐结果  
```  

#### 2. 管理员操作流程  
```
访问隐藏URL → 输入账号密码 → JWT令牌认证 → 进入管理后台  
├─ 留言管理：筛选留言→点击置顶/删除→调用对应API → 数据库更新+Redis缓存失效  
├─ 酒单管理：酒品增删改查 → 清除酒品缓存  
└─ 推荐管理：配置问题选项权重→保存至recommendation表 → 刷新推荐规则缓存  
```  


### 七、非功能需求说明  
#### 1. 性能优化  
- 图片压缩（OSS上传前自动压缩，WebP格式）  
- 分页查询优化（留言板采用游标分页，避免全表扫描）  

#### 2. 安全防护  
- 防XSS：前端输入过滤+后端HTML转义  
- 防恶意请求：Nginx限流（IP+接口维度），登录失败次数限制  
- 敏感词过滤：使用开源词库（如易盾）+ 自定义规则  

#### 3. 兼容性适配  
- 浏览器：仅支持微信内置浏览器（iOS/Android）  
- 分辨率：适配主流手机屏幕（320px-768px）  
